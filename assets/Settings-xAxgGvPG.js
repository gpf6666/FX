var M=Object.defineProperty;var u=(V,m)=>M(V,"name",{value:m,configurable:!0});import{r as v,X as x,y as R,A as s,Q as l,al as d,I as a,aC as T,z as j,M as y}from"./vendor-4TsGYA0n.js";import{u as q,b as A}from"./index-Chbkutgr.js";import{_ as F}from"./_plugin-vue_export-helper-y4GvAF8u.js";import{d as $,E as f}from"./element-DsYCR5Of.js";const I={class:"settings-page"},z={class:"settings-content"},D={class:"settings-section"},O={class:"settings-section"},Q={class:"settings-item"},X={class:"settings-item"},G={class:"settings-item"},H={class:"settings-section"},J={class:"settings-item"},K={class:"settings-item"},L={class:"settings-section"},W={__name:"Settings",setup(V){const m=T(),S=q(),p=v(!1),g=v(!1),P=v(),i=x({notifications:!0,sound:!0,vibration:!0,onlineStatus:!0,lastSeen:!0}),n=x({currentPassword:"",newPassword:"",confirmPassword:""}),C={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:u((r,o,e)=>{o!==n.newPassword?e(new Error("两次输入的密码不一致")):e()},"validator"),trigger:"blur"}]},U=u(()=>{m.back()},"goBack"),B=u(()=>{m.push("/profile")},"goToProfile"),E=u(async()=>{var r,o;try{await P.value.validate(),(await A.post("/api/auth/change-password",{currentPassword:n.currentPassword,newPassword:n.newPassword})).data.success&&(f.success("密码修改成功"),p.value=!1,Object.assign(n,{currentPassword:"",newPassword:"",confirmPassword:""}))}catch(e){(o=(r=e.response)==null?void 0:r.data)!=null&&o.message?f.error(e.response.data.message):f.error("密码修改失败")}},"changePassword"),N=u(async()=>{try{await $.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await S.logout(),m.push("/login"),f.success("已退出登录")}catch(r){r!=="cancel"&&f.error("退出登录失败")}},"logout");return(r,o)=>{const e=d("el-switch"),w=d("el-input"),c=d("el-form-item"),_=d("el-form"),b=d("el-button"),k=d("el-dialog");return j(),R("div",I,[s("div",{class:"settings-header"},[s("button",{class:"back-btn",onClick:U,"aria-label":"返回"},o[13]||(o[13]=[s("i",{class:"iconfont icon-back"},null,-1)])),o[14]||(o[14]=s("h2",null,"设置",-1))]),s("div",z,[s("div",D,[o[17]||(o[17]=s("h3",null,"账户设置",-1)),s("div",{class:"settings-item",onClick:B},o[15]||(o[15]=[s("div",{class:"item-left"},[s("i",{class:"iconfont icon-user"}),s("span",null,"个人资料")],-1),s("i",{class:"iconfont icon-arrow-right"},null,-1)])),s("div",{class:"settings-item",onClick:o[0]||(o[0]=t=>p.value=!0)},o[16]||(o[16]=[s("div",{class:"item-left"},[s("i",{class:"iconfont icon-lock"}),s("span",null,"修改密码")],-1),s("i",{class:"iconfont icon-arrow-right"},null,-1)]))]),s("div",O,[o[21]||(o[21]=s("h3",null,"聊天设置",-1)),s("div",Q,[o[18]||(o[18]=s("div",{class:"item-left"},[s("i",{class:"iconfont icon-notification"}),s("span",null,"消息通知")],-1)),l(e,{modelValue:i.notifications,"onUpdate:modelValue":o[1]||(o[1]=t=>i.notifications=t)},null,8,["modelValue"])]),s("div",X,[o[19]||(o[19]=s("div",{class:"item-left"},[s("i",{class:"iconfont icon-sound"}),s("span",null,"声音提醒")],-1)),l(e,{modelValue:i.sound,"onUpdate:modelValue":o[2]||(o[2]=t=>i.sound=t)},null,8,["modelValue"])]),s("div",G,[o[20]||(o[20]=s("div",{class:"item-left"},[s("i",{class:"iconfont icon-vibration"}),s("span",null,"震动提醒")],-1)),l(e,{modelValue:i.vibration,"onUpdate:modelValue":o[3]||(o[3]=t=>i.vibration=t)},null,8,["modelValue"])])]),s("div",H,[o[24]||(o[24]=s("h3",null,"隐私设置",-1)),s("div",J,[o[22]||(o[22]=s("div",{class:"item-left"},[s("i",{class:"iconfont icon-eye"}),s("span",null,"在线状态可见")],-1)),l(e,{modelValue:i.onlineStatus,"onUpdate:modelValue":o[4]||(o[4]=t=>i.onlineStatus=t)},null,8,["modelValue"])]),s("div",K,[o[23]||(o[23]=s("div",{class:"item-left"},[s("i",{class:"iconfont icon-last-seen"}),s("span",null,"最后在线时间")],-1)),l(e,{modelValue:i.lastSeen,"onUpdate:modelValue":o[5]||(o[5]=t=>i.lastSeen=t)},null,8,["modelValue"])])]),s("div",L,[o[26]||(o[26]=s("h3",null,"关于",-1)),o[27]||(o[27]=s("div",{class:"settings-item"},[s("div",{class:"item-left"},[s("i",{class:"iconfont icon-info"}),s("span",null,"版本信息")]),s("span",{class:"version-text"},"v1.0.0")],-1)),s("div",{class:"settings-item",onClick:o[6]||(o[6]=t=>g.value=!0)},o[25]||(o[25]=[s("div",{class:"item-left"},[s("i",{class:"iconfont icon-help"}),s("span",null,"帮助与反馈")],-1),s("i",{class:"iconfont icon-arrow-right"},null,-1)]))]),s("div",{class:"settings-section"},[s("div",{class:"settings-item logout-item",onClick:N},o[28]||(o[28]=[s("div",{class:"item-left"},[s("i",{class:"iconfont icon-logout"}),s("span",null,"退出登录")],-1)]))])]),l(k,{modelValue:p.value,"onUpdate:modelValue":o[11]||(o[11]=t=>p.value=t),title:"修改密码",width:"400px"},{footer:a(()=>[l(b,{onClick:o[10]||(o[10]=t=>p.value=!1)},{default:a(()=>o[29]||(o[29]=[y("取消",-1)])),_:1,__:[29]}),l(b,{type:"primary",onClick:E},{default:a(()=>o[30]||(o[30]=[y("确认",-1)])),_:1,__:[30]})]),default:a(()=>[l(_,{model:n,rules:C,ref_key:"passwordFormRef",ref:P},{default:a(()=>[l(c,{label:"当前密码",prop:"currentPassword"},{default:a(()=>[l(w,{modelValue:n.currentPassword,"onUpdate:modelValue":o[7]||(o[7]=t=>n.currentPassword=t),type:"password"},null,8,["modelValue"])]),_:1}),l(c,{label:"新密码",prop:"newPassword"},{default:a(()=>[l(w,{modelValue:n.newPassword,"onUpdate:modelValue":o[8]||(o[8]=t=>n.newPassword=t),type:"password"},null,8,["modelValue"])]),_:1}),l(c,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[l(w,{modelValue:n.confirmPassword,"onUpdate:modelValue":o[9]||(o[9]=t=>n.confirmPassword=t),type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(k,{modelValue:g.value,"onUpdate:modelValue":o[12]||(o[12]=t=>g.value=t),title:"关于",width:"500px"},{default:a(()=>o[31]||(o[31]=[s("div",{class:"about-content"},[s("h3",null,"微信风格聊天应用"),s("p",null,"这是一个基于Vue 3和Node.js开发的实时聊天应用，模仿微信的界面和功能。"),s("h4",null,"主要功能："),s("ul",null,[s("li",null,"实时私聊和群聊"),s("li",null,"朋友圈动态"),s("li",null,"头像上传"),s("li",null,"消息状态显示"),s("li",null,"在线状态")]),s("h4",null,"技术栈："),s("ul",null,[s("li",null,"前端：Vue 3 + Element Plus + Socket.io"),s("li",null,"后端：Node.js + Express + MongoDB"),s("li",null,"实时通信：Socket.io")])],-1)])),_:1,__:[31]},8,["modelValue"])])}}},ts=F(W,[["__scopeId","data-v-9a31d1e8"]]);export{ts as default};
