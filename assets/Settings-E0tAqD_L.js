var l=(l,e,s)=>new Promise(((n,a)=>{var t=l=>{try{i(s.next(l))}catch(e){a(e)}},o=l=>{try{i(s.throw(l))}catch(e){a(e)}},i=l=>l.done?n(l.value):Promise.resolve(l.value).then(t,o);i((s=s.apply(l,e)).next())}));import{r as e,X as s,y as n,A as a,Q as t,al as o,I as i,aC as r,z as u,M as c}from"./vendor-BU-zYVMe.js";import{u as d,b as m}from"./index-zPCyQuwE.js";import{_ as p}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{d as f,E as v}from"./element-LGSq3epL.js";const g={class:"settings-page"},w={class:"settings-content"},V={class:"settings-section"},h={class:"settings-section"},P={class:"settings-item"},b={class:"settings-item"},_={class:"settings-item"},y={class:"settings-section"},k={class:"settings-item"},x={class:"settings-item"},U={class:"settings-section"},S=p({__name:"Settings",setup(p){const S=r(),C=d(),j=e(!1),E=e(!1),q=e(),B=s({notifications:!0,sound:!0,vibration:!0,onlineStatus:!0,lastSeen:!0}),I=s({currentPassword:"",newPassword:"",confirmPassword:""}),M={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(l,e,s)=>{e!==I.newPassword?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]},N=()=>{S.back()},T=()=>{S.push("/profile")},z=()=>l(this,null,(function*(){var l,e;try{yield q.value.validate();(yield m.post("/api/auth/change-password",{currentPassword:I.currentPassword,newPassword:I.newPassword})).data.success&&(v.success("密码修改成功"),j.value=!1,Object.assign(I,{currentPassword:"",newPassword:"",confirmPassword:""}))}catch(s){(null==(e=null==(l=s.response)?void 0:l.data)?void 0:e.message)?v.error(s.response.data.message):v.error("密码修改失败")}})),A=()=>l(this,null,(function*(){try{yield f.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield C.logout(),S.push("/login"),v.success("已退出登录")}catch(l){"cancel"!==l&&v.error("退出登录失败")}}));return(l,e)=>{const s=o("el-switch"),r=o("el-input"),d=o("el-form-item"),m=o("el-form"),p=o("el-button"),f=o("el-dialog");return u(),n("div",g,[a("div",{class:"settings-header"},[a("button",{class:"back-btn",onClick:N,"aria-label":"返回"},e[13]||(e[13]=[a("i",{class:"iconfont icon-back"},null,-1)])),e[14]||(e[14]=a("h2",null,"设置",-1))]),a("div",w,[a("div",V,[e[17]||(e[17]=a("h3",null,"账户设置",-1)),a("div",{class:"settings-item",onClick:T},e[15]||(e[15]=[a("div",{class:"item-left"},[a("i",{class:"iconfont icon-user"}),a("span",null,"个人资料")],-1),a("i",{class:"iconfont icon-arrow-right"},null,-1)])),a("div",{class:"settings-item",onClick:e[0]||(e[0]=l=>j.value=!0)},e[16]||(e[16]=[a("div",{class:"item-left"},[a("i",{class:"iconfont icon-lock"}),a("span",null,"修改密码")],-1),a("i",{class:"iconfont icon-arrow-right"},null,-1)]))]),a("div",h,[e[21]||(e[21]=a("h3",null,"聊天设置",-1)),a("div",P,[e[18]||(e[18]=a("div",{class:"item-left"},[a("i",{class:"iconfont icon-notification"}),a("span",null,"消息通知")],-1)),t(s,{modelValue:B.notifications,"onUpdate:modelValue":e[1]||(e[1]=l=>B.notifications=l)},null,8,["modelValue"])]),a("div",b,[e[19]||(e[19]=a("div",{class:"item-left"},[a("i",{class:"iconfont icon-sound"}),a("span",null,"声音提醒")],-1)),t(s,{modelValue:B.sound,"onUpdate:modelValue":e[2]||(e[2]=l=>B.sound=l)},null,8,["modelValue"])]),a("div",_,[e[20]||(e[20]=a("div",{class:"item-left"},[a("i",{class:"iconfont icon-vibration"}),a("span",null,"震动提醒")],-1)),t(s,{modelValue:B.vibration,"onUpdate:modelValue":e[3]||(e[3]=l=>B.vibration=l)},null,8,["modelValue"])])]),a("div",y,[e[24]||(e[24]=a("h3",null,"隐私设置",-1)),a("div",k,[e[22]||(e[22]=a("div",{class:"item-left"},[a("i",{class:"iconfont icon-eye"}),a("span",null,"在线状态可见")],-1)),t(s,{modelValue:B.onlineStatus,"onUpdate:modelValue":e[4]||(e[4]=l=>B.onlineStatus=l)},null,8,["modelValue"])]),a("div",x,[e[23]||(e[23]=a("div",{class:"item-left"},[a("i",{class:"iconfont icon-last-seen"}),a("span",null,"最后在线时间")],-1)),t(s,{modelValue:B.lastSeen,"onUpdate:modelValue":e[5]||(e[5]=l=>B.lastSeen=l)},null,8,["modelValue"])])]),a("div",U,[e[26]||(e[26]=a("h3",null,"关于",-1)),e[27]||(e[27]=a("div",{class:"settings-item"},[a("div",{class:"item-left"},[a("i",{class:"iconfont icon-info"}),a("span",null,"版本信息")]),a("span",{class:"version-text"},"v1.0.0")],-1)),a("div",{class:"settings-item",onClick:e[6]||(e[6]=l=>E.value=!0)},e[25]||(e[25]=[a("div",{class:"item-left"},[a("i",{class:"iconfont icon-help"}),a("span",null,"帮助与反馈")],-1),a("i",{class:"iconfont icon-arrow-right"},null,-1)]))]),a("div",{class:"settings-section"},[a("div",{class:"settings-item logout-item",onClick:A},e[28]||(e[28]=[a("div",{class:"item-left"},[a("i",{class:"iconfont icon-logout"}),a("span",null,"退出登录")],-1)]))])]),t(f,{modelValue:j.value,"onUpdate:modelValue":e[11]||(e[11]=l=>j.value=l),title:"修改密码",width:"400px"},{footer:i((()=>[t(p,{onClick:e[10]||(e[10]=l=>j.value=!1)},{default:i((()=>e[29]||(e[29]=[c("取消",-1)]))),_:1,__:[29]}),t(p,{type:"primary",onClick:z},{default:i((()=>e[30]||(e[30]=[c("确认",-1)]))),_:1,__:[30]})])),default:i((()=>[t(m,{model:I,rules:M,ref_key:"passwordFormRef",ref:q},{default:i((()=>[t(d,{label:"当前密码",prop:"currentPassword"},{default:i((()=>[t(r,{modelValue:I.currentPassword,"onUpdate:modelValue":e[7]||(e[7]=l=>I.currentPassword=l),type:"password"},null,8,["modelValue"])])),_:1}),t(d,{label:"新密码",prop:"newPassword"},{default:i((()=>[t(r,{modelValue:I.newPassword,"onUpdate:modelValue":e[8]||(e[8]=l=>I.newPassword=l),type:"password"},null,8,["modelValue"])])),_:1}),t(d,{label:"确认新密码",prop:"confirmPassword"},{default:i((()=>[t(r,{modelValue:I.confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=l=>I.confirmPassword=l),type:"password"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),t(f,{modelValue:E.value,"onUpdate:modelValue":e[12]||(e[12]=l=>E.value=l),title:"关于",width:"500px"},{default:i((()=>e[31]||(e[31]=[a("div",{class:"about-content"},[a("h3",null,"微信风格聊天应用"),a("p",null,"这是一个基于Vue 3和Node.js开发的实时聊天应用，模仿微信的界面和功能。"),a("h4",null,"主要功能："),a("ul",null,[a("li",null,"实时私聊和群聊"),a("li",null,"朋友圈动态"),a("li",null,"头像上传"),a("li",null,"消息状态显示"),a("li",null,"在线状态")]),a("h4",null,"技术栈："),a("ul",null,[a("li",null,"前端：Vue 3 + Element Plus + Socket.io"),a("li",null,"后端：Node.js + Express + MongoDB"),a("li",null,"实时通信：Socket.io")])],-1)]))),_:1,__:[31]},8,["modelValue"])])}}},[["__scopeId","data-v-9a31d1e8"]]);export{S as default};
